- ManyToManyField
    - 중개 테이블을 자동으로 생성
        - 중개 테이블 기본 명
            - <app_name>_<containing_model>_<field_name>
        - 중개 테이블 내 기본 필드 명
            1. 소스 및 대상 모델이 다른 경우
                - id
                - <containing_model>_id
                - <other_model>_id
            2. 동일한 모델을 가리키는 경우('self')
                - id
                - from_<model>_id
                - to_<model>_id
    - arguments
        - related_name
            - ForeignKey와 동일
        - through
            - 중개 테이블을 직접 작성하는 경우
            - 일반적으로 중개 테이블에 추가 데이터를 사용할 경우 사용
        - symmetrical
            - 기본 값은 True
            - ManyToManyField가 동일한 모델('self')을 가리키는 경우 사용
            - 참조를 하는 경우 반대의 경우도 자동으로 참조하도록 함
                - 대칭을 원하지 않은 경우 False
        - methods
            - `.add()`
                - 지정된 객체를 관련 객체 집합에 추가
            - `.remove()`
                - 관련 객체 집합에서 지정된 모델 개체를 제거

- Article - User
    - 좋아요 기능 구현
    - 이전 N:1 관계에서 이미 article_set 매니저가 생성되어 사용 중이므로 두 곳중 하나에는 related_name을 작성해야 함
        - `like_users = models.ManyToManyField(settings.AUTH_USER_MODEL, related_name='like_articles')`
    - views
        ```python
        @require_POST
        def likes(request, article_pk):
            if request.user.is_authenticated:
                article = Article.objects.get(pk=article_pk)
                if article.like_users.filter(pk=request.user.pk).exists():
                    article.like_users.remove(request.user)
                else:
                    article.like.users.add(request.user)
                return redirect('articles:index')
            return redirect('accounts:login')
        ```
        - `.exists()`
            - QuerySet에 결과가 포함되어 있는지를 반환
    - 템플릿
        - exists를 못쓰므로 `{% if request.user in article.like_users.all %}` 사용

- User - User
    - 팔로우 기능 구현
    - 우선 프로필 페이지 작성
        - views
            ```python
            from django.contrib.auth import get_user_model

            def profile(request, username):
                User = get_user_model()
                person = User.objects.get(username=username)
                context = {
                    'person': person,
                }
                return render(request, 'accounts/profile.html', context)
            ```
        - 템플릿
            - 역참조로 유저가 한 것들 조회 가능
            - `person.article_set.all`
                - 모든 게시글
            - `person.comment_set.all`
                - 모든 댓글
            - `person.like_articles.all`
                - 모든 좋아요한 게시글
    - 모델 작성
        - `followings =models.ManyToManyField('self', symmetrical=False, related_name='followers')`
    - views
        ```python
        @require_POST
        def follow(request, user_pk):
            if request.user.is_authenticated:
                User = get_user_model()
                person = User.objects.get(pk=user_pk)
                if person != request.user:
                    if person.followers.filter(pk=request.user.pk).exists():
                        person.followers.remove(request.user)
                    else:
                        person.followers.add(request.user)
                return redirect('accounts:profile', person.username)
            return redirect('accounts:login')
        ```
    - 템플릿
        - 역시 exists를 못쓰므로 `person.followers.all`
        - `{% request.user != person %}`로 본인이 아닌 경우만 표시
        - `{{ person.followings.all|length }}`로 팔로잉 수
        - `{{ person.followers.all|length }}`로 팔로워 수